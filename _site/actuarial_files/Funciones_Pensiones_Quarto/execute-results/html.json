{
  "hash": "0741ea01be5da397f03ae9dcc3711fcd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Funciones de Pensiones\"\ntoc: true\ntoc-location: right\ntoc-depth: 2\n---\n\n## 1. Tabla de mortalidad\n\nAntes de la función definimos:\n\n-   $l_0 = 100\\,000$\\\n-   $d_x = l_x \\, q_x$\\\n-   $l_{x+1} = l_x - d_x$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nsetwd(\"C:/Users/cubid/Desktop/QUARTO - MATERIAS UNAL/9 CÁLCULO ACTUARIAL/Corte 4 - Pensiones\")\nqx_mujeres_rentistas <- read_excel(\"qx mujeres rentistas.xlsx\",\n                                   col_types = c(\"numeric\",\"numeric\"))\nTablaMortalidad <- function(qx_df, col_qx, l0 = 100000) {\n  edades <- qx_df$x\n  qx     <- qx_df[[col_qx]]\n  n      <- length(qx)\n  lx <- dx <- numeric(n)\n  lx[1] <- l0\n  for(i in seq_len(n - 1)) {\n    dx[i]   <- lx[i] * qx[i]\n    lx[i+1] <- lx[i] - dx[i]\n  }\n  dx[n] <- lx[n] * qx[n]\n  data.frame(x = edades, qx = round(qx,6), lx = round(lx))\n}\ntabla_Rentistas_Mujeres <- TablaMortalidad(qx_mujeres_rentistas, \"qx\")\nhead(tabla_Rentistas_Mujeres)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  x       qx     lx\n1 0 0.000272 100000\n2 1 0.000272  99973\n3 2 0.000272  99946\n4 3 0.000272  99918\n5 4 0.000272  99891\n6 5 0.000272  99864\n```\n\n\n:::\n:::\n\n\n## 2. Mesada pensional — Fondo Privado\n\n**Fórmulas:**\n\n1.  Anualidad temporal:\n\n    $$\n      a_{\\bar n|e} = \\frac{1 - (1+e)^{-n}}{e}\n    $$\n\n2.  Valor presente acumulado (fraccional y unitario):\n\n    $$\n      (VP)^{(m)}_{\\bar n|e} = m\\;\\frac{i}{i^{(m)}}\\;\\frac{1}{1+r}\\;a_{\\bar n|e},\\quad\n      (VP)^{(1)}_{\\bar n|e} = \\frac{1}{1+r}\\;a_{\\bar n|e}\n    $$\n\n3.  Valor presente total y futuro:\n\n    $$\n      (VP)_{\\bar n|e} = (VP)^{(m)}_{\\bar n|e} + (VP)^{(1)}_{\\bar n|e},\\quad\n      (VF)_{\\bar n|e} = (VP)^{(m)}_{\\bar n|e}\\,(1+e)^n\n    $$\n\n4.  Valor presente en edad $x$:\n\n    $$\n      D_x(e) = (1+e)^{-(t-x)}\\,l_t,\\quad\n      N_x(e) = \\sum_{t=x+1}^\\infty D_t(e),\\quad\n      a_{\\bar x|e} = \\frac{N_x(e)}{D_x(e)}\n    $$\n\n5.  Prima de reemplazo:\n\n    $$\n      \\text{tasa}_{\\text{rep}} = \\frac{(VF)_{\\bar n|e}}{(VP)_x}\\;\\times\\;\\text{tasa\\_cotización},\\quad\n      \\text{mesada} = \\text{salario} \\times \\text{tasa}_{\\text{rep}}\n    $$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ne <- 0.03; r <- 0.0788; i <- 0.1112; m <- 12\ntasa_cotizacion <- 0.115\nedades <- tabla_Rentistas_Mujeres$x\n\nmesada_privada <- function(salario_mensual, n, edad, lx) {\n  v   <- 1/(1+r)\n  i_m <- m*((1+i)^(1/m)-1)\n  # 1) VP y VF\n  a_n_e   <- (1-(1+e)^(-n))/e\n  VPm     <- m*i/i_m * v * a_n_e\n  VP1     <- v * a_n_e\n  VP_n_e  <- VPm + VP1\n  VF_n_e  <- VP_n_e * (1+e)^n\n  # 2) VP_x y a_x_e\n  idx     <- match(edad, edades)\n  ages    <- edades[idx:length(edades)]\n  lx_sub  <- lx[idx:length(lx)]\n  k_sub   <- ages - edad\n  Dxe     <- (1+e)^(-k_sub) * lx_sub\n  Nxe     <- sum(Dxe[-1]); Dxe0 <- Dxe[1]\n  a_x_e   <- Nxe / Dxe0\n  VP_x    <- 12*(a_x_e/(1+r)*(1+r*(m-1)/(2*m)) + (m-1)/(2*m)) +\n             a_x_e/(1+r)\n  # 3) mesada\n  tasa_rep <- (VF_n_e / VP_x) * tasa_cotizacion\n  salario_mensual * tasa_rep\n}\n\nmesada_privada(7.7 * 1423500, n = 25, edad = 57,\n               lx = tabla_Rentistas_Mujeres$lx)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2444608\n```\n\n\n:::\n:::\n\n\n## 3. Mesada pensional — Fondo Público\n\n**Reglas:**\n\n$$\n\\text{tasa}_{\\text{rep}} =\n\\begin{cases}\n0.65 - 0.005\\,S, & n = 25,\\\\\n0.65 - 0.005\\,S + 0.015\\,(n-25), & n > 25.\n\\end{cases}\n$$ Asumiendo que cada año tuviera 50 semanas solamente.\n\nY si la mesada es menos de un salario mínimo, el estado subsidiara el restante así sea fondo privado o público.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSMLV <- 1423500\nmesada_publica <- function(salario_mensual, n) {\n  S <- salario_mensual / SMLV\n  tasa_rep <- if(n==25) {\n    0.65 - 0.005*S\n  } else if(n>25) {\n    0.65 - 0.005*S + 0.015*(n-25)\n  } else stop(\"Años < 25 no aplican\")\n  salario_mensual * tasa_rep\n}\n\nmesada_publica(2.3 * SMLV, n = 25)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2090481\n```\n\n\n:::\n:::\n\n\n## 4. Mesada bajo reforma combinada\n\nSe aplica pública hasta $2.3$ SMLV y privada sobre el exceso.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmesada_actual <- function(salario_mensual, n, edad, lx) {\n  limite <- 2.3 * SMLV\n  if (salario_mensual <= limite) {\n    mesada_publica(salario_mensual, n)\n  } else {\n    mp    <- mesada_publica(limite, n)\n    exceso<- salario_mensual - limite\n    mpr   <- mesada_privada(exceso, n, edad, lx)\n    mp + mpr\n  }\n}\n\nmesada_actual(10 * SMLV, n = 25, edad = 57,\n              lx = tabla_Rentistas_Mujeres$lx)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4535089\n```\n\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}